#include "csro_common.h"

static float ntc_3950_res_array[81] = {
    97.0264, 91.5547, 86.4258, 81.6163, 77.1043, 72.8697, 68.8937, 65.1592, 61.65, 58.3513,
    55.2491, 52.3307, 49.5841, 46.9982, 44.5627, 42.268, 40.1052, 38.0658, 36.1423, 34.3274,
    32.6142, 30.9966, 29.4688, 28.0251, 26.6606, 25.3704, 24.1501, 22.9955, 21.9028, 20.8682,
    19.8884, 18.9602, 18.0806, 17.2467, 16.4561, 15.7061, 14.9945, 14.3191, 13.6779, 13.0690,
    12.4905, 11.9400, 11.4184, 10.9217, 10.4494, 10.0, 9.5724, 9.1654, 8.7779, 8.4089,
    8.0574, 7.7225, 7.4033, 7.099, 6.8088, 6.5321, 6.268, 6.016, 5.7755, 5.5459,
    5.3266, 5.1171, 4.9169, 4.7257, 4.5428, 4.368, 4.2008, 4.0409, 3.8878, 3.7414,
    3.6012, 3.467, 3.3385, 3.2154, 3.0975, 2.9845, 2.8762, 2.7723, 2.6727, 2.5772, 2.4856};

static float ntc_3380_res_array[81] = {
    69.6931, 66.3291, 63.1485, 60.1402, 57.2939, 54.5998, 52.049, 49.633, 47.3439, 45.1743,
    43.1172, 41.1663, 39.3153, 37.5587, 35.891, 34.3074, 32.8029, 31.3734, 30.0145, 28.7225, 27.4936,
    26.3245, 25.2119, 24.1527, 23.1442, 22.1835, 21.2682, 20.3959, 19.5644, 18.7714, 18.0151,
    17.2935, 16.6048, 15.9475, 15.3198, 14.7203, 14.1475, 13.6003, 13.0772, 12.5771, 12.0988,
    11.6413, 11.2037, 10.7848, 10.3839, 10, 9.6324, 9.2802, 8.9428, 8.6195, 8.3096,
    8.0124, 7.7275, 7.4541, 7.1919, 6.9403, 6.6987, 6.4669, 6.2442, 6.0304, 5.825,
    5.6276, 5.438, 5.2557, 5.0804, 4.9119, 4.7498, 4.5939, 4.4439, 4.2995, 4.1605,
    4.0268, 3.898, 3.7739, 3.6544, 3.5393, 3.4284, 3.3215, 3.2185, 3.1191, 3.0234};

float Csro_Calculate_ntc3950_Temperature_from_Resvalue(float res_value)
{
    if (res_value >= ntc_3950_res_array[0])
    {
        return -20.0;
    }
    for (size_t i = 0; i < 80; i++)
    {
        if ((res_value < ntc_3950_res_array[i]) && (res_value >= ntc_3950_res_array[i + 1]))
        {
            float a = (res_value - ntc_3950_res_array[i + 1]) / (ntc_3950_res_array[i] - ntc_3950_res_array[i + 1]);
            return (i - 19 - a);
        }
    }
    return 60.0;
}

float Csro_Calculate_ntc3380_Temperature_from_Resvalue(float res_value)
{
    if (res_value >= ntc_3380_res_array[0])
    {
        return -20.0;
    }
    for (size_t i = 0; i < 80; i++)
    {
        if ((res_value < ntc_3380_res_array[i]) && (res_value >= ntc_3380_res_array[i + 1]))
        {
            float a = (res_value - ntc_3380_res_array[i + 1]) / (ntc_3380_res_array[i] - ntc_3380_res_array[i + 1]);
            return (i - 19 - a);
        }
    }
    return 60.0;
}
